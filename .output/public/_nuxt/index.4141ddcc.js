import{A as L,k as W,E as B,m as T,M as O,r as g,J as F,N as I,o as $,s as z,b as s,x as v,u as e,c as b,y as C,f as m,Z as M,P as y,K as k,l as N,h as E,p as U,w as q,e as p,v as c,U as x}from"./entry.05f698ef.js";import{a as D,u as Y,L as H}from"./Layout.896833a6.js";import{A as J}from"./ArtworkForm.32597bec.js";import{u as Q}from"./useFeed.d5b8d816.js";import{q as Z,v as j}from"./vue3-editor.common.90d68174.js";import{S as G}from"./ProBadge.0148f2b1.js";import{P as d}from"./index.af539870.js";import{_ as X}from"./_plugin-vue_export-helper.c27b6911.js";import"./useSetting.c4a424f7.js";const ee={class:"title"},te=["name"],se={class:"relative"},oe={class:"text-left-counter"},ae={class:"buttons"},ie=L({__name:"FeedForm",setup(K){const{oApiConfiguration:h,fetchOptions:f}=W(),R=Q(h,f());B(()=>{var t;(t=document.getElementById(l))==null||t.getElementsByClassName("ql-editor")[0]});const o=T(),{t:_}=O(),l="feed-form",n=g(null),r=g(""),w=2e3,A=g(1),S=F(()=>{if(n)return w-(A.value-1)});I(()=>r.value,(t,a)=>{A.value=n.value.getLength(),n.value.getLength()>w&&n.value.deleteText(w,n.value.getLength())});const i=g({isPosting:!1,isPosted:!1,isError:!1}),P=async()=>{Y().validate(l,_),i.value.isPosting=!0;const[t,a,u]=await R.postFeed({text:r.value,visibility:"public",whoCanReply:"public"});if(u)i.value.isError=!0;else{i.value={isPosting:!1,isPosted:!0,isError:!1};const V=a.id;setTimeout(()=>{o.push(`/feed/${V}`)},1e3)}i.value.isPosting=!1};return(t,a)=>($(),z("section",null,[s("h2",ee,v(t.$t("feeds.form.title")),1),s("form",{id:l,onSubmit:a[4]||(a[4]=y(u=>P(),["prevent"]))},[e(i).isPosting|e(i).isError|e(i).isPosted?($(),b(D,{key:0,"is-loading":e(i).isPosting,"loading-message":t.$t("feeds.form.postingYourUpdate"),"is-success":e(i).isPosted,"success-message":`${t.$t("feeds.form.posted")} ${t.$t("feeds.form.successRedirect")}`,"is-error":e(i).isError,"error-message":t.$t("feeds.form.postFailure")},null,8,["is-loading","loading-message","is-success","success-message","is-error","error-message"])):C("",!0),s("n-validate",{for:"text",name:t.$t("feeds.form.feed")},[m(e(j.VueEditor),{modelValue:e(r),"onUpdate:modelValue":a[0]||(a[0]=u=>M(r)?r.value=u:null),"editor-toolbar":e(Z),placeholder:t.$t("typeSomething"),onReady:a[1]||(a[1]=u=>n.value=u)},null,8,["modelValue","editor-toolbar","placeholder"])],8,te),s("div",se,[s("div",oe,v(e(S)),1)]),s("div",ae,[s("button",{type:"reset",class:"reset",onClick:a[2]||(a[2]=y(u=>r.value="",["prevent"]))},v(t.$t("reset")),1),s("button",{class:k(["submit",{"!disabled-button":!e(r)}]),onClick:a[3]||(a[3]=y(u=>e(r)!==""?P():null,["prevent"]))},[t.posting?($(),b(G,{key:0})):C("",!0),s("span",null,v(t.posting?t.$t("posting"):t.$t("post").toUpperCase()),1)],2)])],32)]))}});const le={class:"mb-20"},ne={class:"categories"},re={class:"text-sm leading-6"},ue={class:"text-sm leading-6"},de={class:"forms"},me={__name:"index",setup(K){const h=N(),{t:f}=O(),R=T(),o=g(d.ARTWORK);return E({title:o.value===d.ARTWORK?f("meta.title.artwork.post"):f("meta.title.feed.post")}),I(()=>o.value,()=>{E({title:o.value===d.ARTWORK?f("meta.title.artwork.post"):f("meta.title.feed.post")})}),U(()=>{h.loggedIn||R.push("/explore")}),(_,l)=>($(),b(H,{"with-footer":!0,"hide-side":!1},{default:q(()=>[s("div",le,[s("div",ne,[s("div",{class:k(["category",[e(o)==="feed"?"button":"theme-color"]]),onClick:l[0]||(l[0]=n=>o.value="feed")},[p(m(x,{name:"i-ion-text-outline","text-size":"texl-xl",class:"mr-3 text-2xl"},null,512),[[c,e(o)!="feed"]]),p(m(x,{name:"i-ion-text-outline","text-size":"texl-xl",class:"mr-3 text-2xl text-white"},null,512),[[c,e(o)=="feed"]]),s("span",re,v(_.$t("feed")),1)],2),s("div",{class:k(["category",[e(o)===e(d).ARTWORK?"button":"theme-color"]]),onClick:l[1]||(l[1]=n=>o.value=e(d).ARTWORK)},[p(m(x,{name:"i-ion-images-outline","text-size":"texl-xl",class:"mr-3 text-2xl"},null,512),[[c,e(o)!=e(d).ARTWORK]]),p(m(x,{name:"i-ion-images-outline","text-size":"texl-xl",class:"mr-3 text-2xl text-white"},null,512),[[c,e(o)==e(d).ARTWORK]]),s("span",ue,v(_.$t("artworks.artwork")),1)],2)]),s("div",de,[p(m(ie,null,null,512),[[c,e(o)==="feed"]]),p(m(J,{class:"artwork"},null,512),[[c,e(o)===e(d).ARTWORK]])])])]),_:1}))}},Re=X(me,[["__scopeId","data-v-e012f9ee"]]);export{Re as default};
