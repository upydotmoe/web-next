import{l as te,k as oe,a as z,N as D,r as a,E as H,J as se,o as V,s as K,b as t,x as l,e as h,v as y,u as e,K as n,f as d,U as $,t as M,y as X,Q as pe,V as ne,W as ae,M as me,m as ve,h as ee,c as fe,w as he,O as we,Z as ye,a0 as ge}from"./entry.013e3180.js";import{P as E}from"./index.7225a9bd.js";import{L as be}from"./Layout.8a0d535a.js";import{u as _e}from"./ProBadge.621315e3.js";import{W as ke}from"./WorkList.918875b3.js";import{_ as le}from"./LoadingEmptyErrorMessage.ea9789d6.js";import{M as $e}from"./ModalView.fe17cd98.js";import{_ as J}from"./_plugin-vue_export-helper.c27b6911.js";import{U as xe}from"./UserList.399456f3.js";import{u as Ce}from"./useUser.c528311a.js";import"./useReport.88ae68e1.js";import"./MiniArtworkPreview.da3df71a.js";import"./user-counters-api.1fadf2b7.js";import"./useSetting.109c0793.js";import"./useFeed.b6c30163.js";const re=_=>(ne("data-v-6f0e9e52"),_=_(),ae(),_),Me={id:"options",class:"md:z-10 md:sticky md:top-0"},qe={class:"navigations"},Re={class:"title"},Ae={class:"buttons"},Oe={class:"filter-buttons"},Se={class:"filter-buttons"},Te={key:0,class:"filter-buttons"},Be={key:0,class:"navigations"},Ee=re(()=>t("div",null,null,-1)),Le={class:"buttons"},Ue={class:"filter-buttons"},Pe={class:"filter-buttons"},Ve={class:"inline-block w-full md:w-52 group"},Ie={class:"flex items-center py-2 px-3 w-full rounded-md border-2 border-transparent outline-none md:w-52 theme-color hover:button focus:outline-none"},We={class:"flex-1 pr-1"},Fe=re(()=>t("span",null,[t("svg",{class:"w-4 h-4 transition duration-150 ease-in-out transform fill-current group-hover:-rotate-180",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})])],-1)),Ke={class:"absolute z-10 mt-1 w-full text-center rounded-md transition duration-150 ease-in-out transform origin-top scale-0 md:w-52 theme-color group-hover:scale-100"},Ne={class:"mt-4"},je={id:"popular-modal",class:"modal work-view"},ze={__name:"Artworks",emits:["countArtworks"],setup(_,{emit:S}){const q=te(),{oApiConfiguration:k,fetchOptions:w}=oe(),c=_e(k,w()),R=z(),{q:T}=R.query;D(()=>R.query.q,(o,s)=>{o!==s&&(g.value=o,o&&o!==""&&C())});const g=a(T);H(()=>{C(),A()});const A=()=>{var o=document.createElement("div");o.classList.add("myObserver");var s=document.querySelector("#options");v(o,s);function v(F,G){G.parentNode.insertBefore(F,G)}var ce=new IntersectionObserver(function(F){F[0].intersectionRatio===0?document.querySelector("#options").classList.add("md:pt-4","md:pb-1","md:theme-color-secondary","md:rounded-b-md","md:px-6","md:mt-2","md:border-color-button-color","md:border-2","md:border-t-0"):F[0].intersectionRatio===1&&document.querySelector("#options").classList.remove("md:pt-4","md:pb-1","md:theme-color-secondary","md:rounded-b-md","md:px-6","md:mt-2","md:border-color-button-color","md:border-2","md:border-t-0")},{threshold:[0,1]});ce.observe(document.querySelector(".myObserver"))},p=a("recent"),u=async o=>{p.value=o,await C()},r=a(void 0),f=async o=>{r.value=o,await C()},m=a("views"),L=a(""),O=async(o,s)=>{m.value=o,L.value=s,await C()},x=a("daily"),B=async o=>{x.value=o,await C()},i=a(!1),b=async()=>{i.value=!i.value,await C()},U=a([]),C=async()=>{ue();const{works:o,pagination:s}=await Y();o.length&&s.record_total&&(U.value=o),S("countArtworks",s.record_total)},P=a(!0),I=a(!1),Q=se(()=>!I.value&&!U.value.length),N=a(!0),W=a({perPage:24,page:0}),Y=async()=>{const[o,s]=await c.getSearch({recentMode:p.value==="recent",range:x.value,rangeMode:m.value,explicitMode:r.value,keyword:g.value??"",followingOnly:i.value===!1?void 0:i.value,pagination:{perPage:W.value.perPage,page:W.value.page}});if(P.value=!1,o.pagination.next_previous.next_page||(N.value=!1),s)I.value=!0;else return W.value.page+=1,o},j=a({delay:!1}),ie=async()=>{j.value.delay=!0;const{works:o}=await Y();o.forEach(s=>{U.value.push(s)}),j.value.delay=!1},ue=()=>{U.value=[],N.value=!0,W.value.page=0,P.value=!0,I.value=!1},Z=a(null),de=(o,s=!1)=>{Z.value.view(o,s),pe().openModal("popular-modal")};return(o,s)=>(V(),K("div",null,[t("div",Me,[t("div",qe,[t("div",Re,l(o.$t("artworks.artworks")),1),t("div",Ae,[h(t("div",Oe,[t("button",{class:n(["px-3 rounded-md button-item",e(i)?"button":"theme-color"]),onClick:s[0]||(s[0]=v=>b())},[h(d($,{name:"i-fluent-people-checkmark-24-regular",class:"text-white"},null,512),[[y,e(i)]]),h(d($,{name:"i-fluent-people-checkmark-24-regular"},null,512),[[y,!e(i)]]),M(" "+l(o.$t("followingOnly")),1)],2)],512),[[y,e(q).loggedIn]]),t("div",Se,[t("p",{class:n(["rounded-l-md button-item",[e(p)==="recent"?"button":"theme-color"]]),onClick:s[1]||(s[1]=v=>u("recent"))},l(o.$t("artworks.newest")),3),t("p",{class:n(["rounded-r-md button-item",[e(p)==="popularity"?"button":"theme-color"]]),onClick:s[2]||(s[2]=v=>u("popularity"))},[d($,{name:"i-icon-park-outline-oval-love-two",class:n([{"text-white":e(p)==="popularity"}])},null,8,["class"]),M(" "+l(o.$t("artworks.mostPopular")),1)],2)]),e(q).loggedIn&&e(q).user.user_settings.show_explicit?(V(),K("div",Te,[t("p",{class:n(["rounded-l-md button-item",[e(r)===void 0?"button":"theme-color"]]),onClick:s[3]||(s[3]=v=>f(void 0))},l(o.$t("default")),3),t("p",{class:n(["button-item",[e(r)==="safe"?"button":"theme-color"]]),onClick:s[4]||(s[4]=v=>f("safe"))},l(o.$t("safe")),3),t("p",{class:n(["rounded-r-md button-item",[e(r)==="explicit"?"button":"theme-color"]]),onClick:s[5]||(s[5]=v=>f("explicit"))},[d($,{name:"i-material-symbols-explicit-outline",class:n({"text-white":e(r)==="explicit"})},null,8,["class"]),M(" "+l(o.$t("explicit")),1)],2)])):X("",!0)])]),e(p)==="popularity"?(V(),K("div",Be,[Ee,t("div",Le,[t("div",Ue,[t("p",{class:n(["rounded-l-md button-item",[e(x)==="daily"?"button":"theme-color"]]),onClick:s[6]||(s[6]=v=>B("daily"))},l(o.$t("daily")),3),t("p",{class:n(["button-item",[e(x)==="weekly"?"button":"theme-color"]]),onClick:s[7]||(s[7]=v=>B("weekly"))},l(o.$t("weekly")),3),t("p",{class:n(["button-item",[e(x)==="monthly"?"button":"theme-color"]]),onClick:s[8]||(s[8]=v=>B("monthly"))},l(o.$t("monthly")),3),t("p",{class:n(["rounded-r-md button-item",[e(x)==="all"?"button":"theme-color"]]),onClick:s[9]||(s[9]=v=>B("all"))},l(o.$t("allTime")),3)]),t("div",Pe,[t("div",Ve,[t("button",Ie,[t("span",We,l(e(m)==="views"?o.$t("mostViewed"):e(L)),1),Fe]),t("ul",Ke,[t("li",{class:n(["flex flex-row justify-between py-2 px-3 cursor-pointer hover:button icon-hover-parent",{button:e(m)==="views"}]),onClick:s[10]||(s[10]=v=>O("views",o.$t("mostViewed")))},[d($,{name:"i-mi-eye",class:n({"text-white":e(m)==="views"})},null,8,["class"]),M(" "+l(o.$t("mostViewed")),1)],2),t("li",{class:n(["flex flex-row justify-between py-2 px-3 cursor-pointer hover:button icon-hover-parent",{button:e(m)==="likes"}]),onClick:s[11]||(s[11]=v=>O("likes",o.$t("mostLiked")))},[d($,{name:"i-ri-heart-3-line",class:n({"text-white":e(m)==="likes"})},null,8,["class"]),M(" "+l(o.$t("mostLiked")),1)],2),t("li",{class:n(["flex flex-row justify-between py-2 px-3 rounded-b-md cursor-pointer hover:button icon-hover-parent",{button:e(m)==="comments"}]),onClick:s[12]||(s[12]=v=>O("comments",o.$t("mostCommented")))},[d($,{name:"i-mdi-comment-multiple-outline",class:n({"text-white":e(m)==="comments"})},null,8,["class"]),M(" "+l(o.$t("mostCommented")),1)],2)])])])])])):X("",!0)]),d(le,{loading:e(P),empty:e(Q),error:e(I),fetch:C},null,8,["loading","empty","error"]),h(t("div",Ne,[h(d(ke,{"section-class":"work-grid-6",works:e(U),view:de},null,8,["works"]),[[y,!e(Q)]]),h(t("div",{class:n(["w-full primary-button",e(j).delay?"animate-pulse":""]),onClick:ie},l(o.$t("loadMore")),3),[[y,e(N)]])],512),[[y,!e(P)]]),t("div",je,[h(d($e,{ref_key:"popularModalViewRef",ref:Z,section:"popular"},null,512),[[y,!e(P)]])])]))}},De=J(ze,[["__scopeId","data-v-6f0e9e52"]]);const He=_=>(ne("data-v-aeb34405"),_=_(),ae(),_),Je={class:"navigations"},Qe={class:"title"},Ye=He(()=>t("div",{class:"buttons"},null,-1)),Ze={__name:"Users",emits:["countUsers"],setup(_,{emit:S}){const{oApiConfiguration:q,fetchOptions:k}=oe(),w=Ce(q,k()),c=z(),{q:R}=c.query;D(()=>c.query.q,(i,b)=>{i!==b&&(T.value=i,A())});const T=a(R);H(()=>{setTimeout(()=>{A()},1e3)});const g=a([]),A=async()=>{B();const{users:i,pagination:b}=await L();i.length&&b.record_total&&(g.value=i),S("countUsers",b.record_total)},p=a(!0),u=a(!1),r=se(()=>!u.value&&!g.value.length),f=a(!0),m=a({perPage:16,page:a(0)}),L=async()=>{const[i,b]=await w.searchUsers({keyword:T.value??"",pagination:{page:m.value.page,perPage:m.value.perPage}});if(p.value=!1,i.pagination.next_previous.next_page||(f.value=!1),b)u.value=!0;else return m.value.page+=1,i},O=a({delay:!1,showDiscoveryButton:!1}),x=async()=>{O.value.delay=!0,(await L()).users.forEach(b=>{g.value.push(b)}),O.value.delay=!1},B=()=>{g.value=[],f.value=!0,m.value.page=0,p.value=!0,u.value=!1};return(i,b)=>(V(),K("div",null,[t("div",Je,[t("div",Qe,l(i.$t("users.users")),1),Ye]),d(le,{loading:e(p),empty:e(r),error:e(u),fetch:A},null,8,["loading","empty","error"]),h(t("div",null,[h(d(xe,{users:e(g)},null,8,["users"]),[[y,!e(r)]]),h(t("div",{class:n(["w-full primary-button",e(O).delay?"animate-pulse":""]),onClick:x},l(i.$t("loadMore")),3),[[y,e(f)]])],512),[[y,!e(p)]])]))}},Ge=J(Ze,[["__scopeId","data-v-aeb34405"]]);const Xe={class:"mx-2"},et={id:"lists"},tt={class:"search"},ot=["placeholder"],st={class:"flex flex-row gap-2 mb-6 w-full"},nt={__name:"index",setup(_){te();const{t:S}=me(),q=ve(),k=z();ee({title:S("search.search")+(k.query.q?` "${k.query.q}"`:"")});const w=a("");H(()=>{w.value=k.query.q});const c=a(k.query.t??E.ARTWORK),R=a(0),T=u=>{R.value=u},g=a(0),A=u=>{g.value=u};D(()=>k.query,({q:u})=>{w.value=u,ee({title:S("search.search")+(w.value?` "${w.value}"`:k.query.q)})});const p=()=>{q.push({path:"/search",query:{q:w.value},replace:!0,force:!0})};return(u,r)=>(V(),fe(be,{"with-footer":!0,"hide-side":!0,"no-right-side":!0},{default:he(()=>[t("div",Xe,[t("div",et,[t("span",tt,[h(t("input",{"onUpdate:modelValue":r[0]||(r[0]=f=>ye(w)?w.value=f:null),type:"text",name:"search",placeholder:u.$t("search.search"),onKeyup:r[1]||(r[1]=ge(f=>p(),["enter"]))},null,40,ot),[[we,e(w)]]),t("span",{class:"search-button",onClick:r[2]||(r[2]=f=>p())},[d($,{name:"i-ion-search"})])]),t("div",st,[t("div",{class:n(["px-2 rounded-lg",e(c)===e(E).ARTWORK?"primary-button":"light-bordered-button"]),onClick:r[3]||(r[3]=f=>c.value=e(E).ARTWORK)},[d($,{name:"i-majesticons-image",class:n(["mr-2",{"text-white":e(c)===e(E).ARTWORK}])},null,8,["class"]),M(" "+l(u.$t("artworks.artworks"))+" ",1),t("span",{class:n(["px-1 ml-2 rounded",e(c)===e(E).ARTWORK?"theme-color":"bg-gray-600 text-white"])},l(e(R)),3)],2),t("div",{class:n(["px-2 rounded-lg",e(c)==="users"?"primary-button":"light-bordered-button"]),onClick:r[4]||(r[4]=f=>c.value="users")},[d($,{name:"i-fluent-person-32-regular",class:n(["mr-2",{"text-white":e(c)==="users"}])},null,8,["class"]),M(" "+l(u.$t("users.users"))+" ",1),t("span",{class:n(["px-1 ml-2 rounded",e(c)==="users"?"theme-color":"bg-gray-600 text-white"])},l(e(g)),3)],2)]),h(t("div",null,[d(De,{onCountArtworks:T})],512),[[y,e(c)===e(E).ARTWORK]]),h(t("div",null,[d(Ge,{onCountUsers:A})],512),[[y,e(c)==="users"]])])])]),_:1}))}},bt=J(nt,[["__scopeId","data-v-6def6e87"]]);export{bt as default};
